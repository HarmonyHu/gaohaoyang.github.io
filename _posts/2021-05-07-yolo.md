---
layout: single
title: YOLO网络
categories:
  - AI
tags:
  - 网络模型
---

* content
{:toc}
## 概述



**官网：**[YOLO: Real-Time Object Detection](https://pjreddie.com/darknet/yolo/)

**论文地址**：[YOLO v1 2016](https://arxiv.org/pdf/1506.02640.pdf) 、[YOLO v2 2017](https://arxiv.org/pdf/1612.08242.pdf)、[YOLO v3 2018](https://arxiv.org/pdf/1804.02767.pdf)、[YOLO v4 2020](https://arxiv.org/pdf/2004.10934.pdf)、[YOLO v5 待更新](https://github.com/ultralytics/yolov5)

<!--more-->

## YOLO v1

#### 模型结构

![](https://harmonyhu.github.io/img/yolo_v1.png)

模型结构非常简单，24个卷积层（类似VGG16）部分复杂提取特征，2个全连接层复杂预测。

过程如下：

1. 输入为[1, 3, 448, 448]，经过中间卷积层，得到输出为[1, 512, 7, 7]；
2. [1, 512, 7, 7]=>[1, 25088]，做全连接[25088, 4096]（**此处参数量非常庞大**）， 得到[1, 4096];
3. [1, 4096]，做全连接[4096, 1470]（**此处参数量非常庞大**），得到[1, 1470]
4. [1, 1470] => [1, 7, 7, 30]

#### 输出格式

![](https://harmonyhu.github.io/img/yolo_v1_io.png)

* 对原图SxS个中心点检测，这里S对应7
* B为检测box数量，这里B为2
* 每个box坐标为$ (x_{center}, y_{center}, w, h) $，数值等比缩放到[0,1]区间，加上一个检测的confidence(置信度)。
* C为类别，one-hot vector形式，这里为20

#### 特点

* 通过卷积+全连接，直接推导出位置和类别，是yolo网络的主要特点
* 最后两层全连接参数量很大，可以继续优化

## YOLO v2

#### 模型结构

![](https://harmonyhu.github.io/img/yolo_v2.jpg)

说明：

* 模型结构依然非常简单，相对YOLO v1最主要是的将两个全连接改成了卷积实现
* 输出为1x425x13x13，也可以permute成1x13x13x425来对比看待
* 其中reorg为重组层，将平面数据重组到深度上

#### 输出格式

![](https://harmonyhu.github.io/img/yolo_v2_io.jpg)

* 将原图划分为13x13个中心点检测
* 425 = 17个先验框 * (坐标4 + 置信度1 + 类型20)

