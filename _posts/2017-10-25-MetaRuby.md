---
layout: post
title:  Ruby元编程
categories: Ruby
tags: Ruby
---

* content
{:toc}

### eval函数
该函数将字符串解析成代码，如下示例

* 传入变量字符串，解析成变量
```ruby
test = "abc"
puts eval("test")
#打印abc
puts eval("0x12")
#打印18
```


* 传入函数字符串，解析调用后的结果
```ruby
def func(a)
	return a*a
end
puts eval("func(10)")
#打印100
```

### class方法
该方法可以得到变量的类型，如下示例
```ruby
"abc".class #String 类
"abc".class.name #"String" 类名
"abc".class.new("ef") #用"abc"的类创建一个新类，内容是"ef"
"abc".class.methods #得到String类的所有方法，等同于String.methods
"abc".class.methods.class #Array
```

### methods方法
该方法可以得到类或对象的所有方法，数组形式
```ruby
123.methods
# [:%, :&, :*, :+, :-, :/, :<, :>, :^, :|, :~, :-@, :**, :<=>, :<<, :>>, :<=, :>=, :==, :===, :[], :inspect, :size, :succ, :to_int, :to_s, :to_i, :to_f, :next, :div, :upto, :chr, :ord, :coerce, :divmod, :fdiv, :modulo, :remainder, :abs, :magnitude, :integer?, :floor, :ceil, :round, :truncate, :odd?, :even?, :downto, :times, :pred, :bit_length, :digits, :to_r, :numerator, :denominator, :rationalize, :gcd, :lcm, :gcdlcm, :+@, :eql?, :singleton_method_added, :i, :real?, :zero?, :nonzero?, :finite?, :infinite?, :step, :positive?, :negative?, :quo, :arg, :rectangular, :rect, :polar, :real, :imaginary, :imag, :abs2, :angle, :phase, :conjugate, :conj, :to_c, :between?, :clamp, :instance_of?, :kind_of?, :is_a?, :tap, :public_send, :define_singleton_method, :method, :public_method, :remove_instance_variable, :instance_variable_set, :singleton_method, :extend, :to_enum, :enum_for, :=~, :!~, :respond_to?, :freeze, :object_id, :send, :display, :nil?, :hash, :class, :singleton_class, :clone, :dup, :itself, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :frozen?, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variable_get, :instance_variables, :instance_variable_defined?, :!, :!=, :__send__, :equal?, :instance_eval, :instance_exec, :__id__]
```

### instance_variables方法
该方法得到实例的变量，数组形式
```ruby
class Cat
	def method
		@name = "Cat ^_^"
		@kind = "animal"
	end
end
cat = Cat.new
puts cat.instance_variables.inspect
#打印[]
cat.method
puts cat.instance_variables.inspect
#打印[:@name, :@kind]
```

### 打开类
直接打开已有的类，添加内容，如下示例
```ruby
class String
	def title
		"$ " + self
	end
end

puts "abc".title
#打印$ abc
```