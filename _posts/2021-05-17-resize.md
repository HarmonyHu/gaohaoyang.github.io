---
layout: single
title: Resize
categories:
  - AI
tags:
  - 算法
---

* content
{:toc}
## 概述

**ONNX操作描述：**[Resize](https://github.com/onnx/onnx/blob/master/docs/Operators.md#Resize)

**参考代码：**[resize.py](https://github.com/onnx/onnx/blob/master/onnx/backend/test/case/node/resize.py)

**变换方式：** `half_pixel`、`align_corners`、`asymmetric`、`pytorch_half_pixel`、`tf_crop_and_resize`

**模式：** `linear`和`nearest`

本文以 $ A[h_a, w_a] $ 与 $ B[h_b, w_b] $之间的resize举例。

<!--more-->



## Half Pixel

将A中各元素摆放在$ h_a \times w_a $的区域中，将B中各元素摆放在$ h_b \times w_b $的区域中。

那么A中各点的坐标位置对应如下：

$ A_{[0,0]} => [0.5, 0.5]$

$ A_{[0,1]} => [0.5, 1.5]$

$ A_{[y,x]} => [0.5 + y, 0.5 + x] $

B中各元素位置同理。

如果是A resize to B，则先将B区域拉伸至A区域范围；

如果是B resize to A，则先将A区域拉伸至B区域范围。

如下图所示：

![](https://harmonyhu.github.io/img/half_pixel.jpg)

[**注：**A拉伸至B，或者B拉伸至A都可以，不影响结果]

以图中A resize to B举例，则有：

$ scale_w = \frac{w_b}{w_a} $

$ scale_h = \frac{h_b}{h_a} $

那么经过变化后B中各点的坐标位置对应如下：

$ B_{[0,0]} => [\frac{0.5}{scale_h}, \frac{0.5}{scale_w}] $

$ B_{[0,1]} => [\frac{0.5}{scale_h}, \frac{1.5}{scale_w}] $

$ B_{[y,x]} => [\frac{0.5+y}{scale_h}, \frac{0.5+x}{scale_w}] $

然后按照最近的四个A点做双线性差值，得到B点的值。如果B点在w或h方向上超出A边缘，则在该方向上取A边缘值。
